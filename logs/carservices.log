2025-11-18T00:17:59.194+04:00  WARN 23528 --- [carservices] [HikariPool-41 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-41 - Thread starvation or clock leap detected (housekeeper delta=1h13m5s620ms42µs900ns).
2025-11-18T09:31:42.949+04:00  WARN 23528 --- [carservices] [HikariPool-41 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-41 - Thread starvation or clock leap detected (housekeeper delta=9h13m47s559ms156µs500ns).
2025-11-18T12:50:15.779+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815778 | took 27ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T12:50:15.847+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815847 | took 9ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'SUNDAY'
    LIMIT 1
;
2025-11-18T12:50:15.861+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815861 | took 2ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T12:50:15.863+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815863 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T12:50:15.870+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815870 | took 5ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T12:50:15.901+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815901 | took 11ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.907+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815907 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.911+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815911 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.915+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815915 | took 1ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.921+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815921 | took 2ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.925+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815925 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.928+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815928 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.931+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815931 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.934+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815934 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.936+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815936 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.939+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815939 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.943+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815943 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.946+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815946 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.948+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815948 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.950+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815950 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.954+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815954 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.957+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815957 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.959+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815959 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.961+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815961 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.963+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815963 | took 2ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T12:50:15.974+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815974 | took 1ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'SUNDAY'
    LIMIT 1
;
2025-11-18T12:50:15.977+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815977 | took 1ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T12:50:15.979+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815979 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T12:50:15.980+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815980 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T12:50:15.982+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815982 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.983+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815983 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.986+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815986 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.988+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815988 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.993+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815993 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.995+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815995 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.998+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815998 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.998+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815998 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:15.999+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455815999 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:16.001+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455816001 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:16.002+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455816002 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:16.004+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455816004 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:16.005+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455816005 | took 0ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T12:50:16.008+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763455816008 | took 1ms | statement | connection 640| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:05:28.344+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)         AVG(re.stars) OVER (PARTITION 
    BY
        b.branch_id) AS avgStars     
    FROM
        branch b     
    LEFT JOIN
        branch_brand_service bbs 
            ON bbs.branch_id = b.branch_id     
    LEFT JOIN
        service_entity s 
            ON s.service_id = bbs.service_id     
    LEFT JOIN
        rate_experience re 
            ON re.branch_brand_serviceid = bbs.id     
    WHERE
        b.status = 'approved' 
        OR b.status = 'APPROVED'     
    ORDER BY
        b.branch_id 
2025-11-18T13:05:28.386+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.city 
    from
        city c1_0
2025-11-18T13:05:28.391+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        b1_0.brand_id,
        b1_0.brand_name 
    from
        brand b1_0
2025-11-18T13:05:28.391+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        se1_0.service_id,
        se1_0.service_name,
        se1_0.service_type 
    from
        service_entity se1_0
2025-11-18T13:05:28.400+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763456728400 | took 11ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
select c1_0.id,c1_0.city from city c1_0
select c1_0.id,c1_0.city from city c1_0;
2025-11-18T13:05:28.404+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763456728404 | took 5ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0;
2025-11-18T13:05:28.404+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763456728404 | took 5ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
select b1_0.brand_id,b1_0.brand_name from brand b1_0
select b1_0.brand_id,b1_0.brand_name from brand b1_0;
2025-11-18T13:05:28.412+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763456728412 | took 1ms | commit | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.416+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-9] p6spy                                    : #1763456728416 | took 56ms | statement | connection 653| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id

    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id
;
2025-11-18T13:05:28.416+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763456728416 | took 2ms | commit | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.417+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763456728417 | took 0ms | commit | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.456+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.city 
    from
        city c1_0
2025-11-18T13:05:28.456+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        b1_0.brand_id,
        b1_0.brand_name 
    from
        brand b1_0
2025-11-18T13:05:28.460+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        se1_0.service_id,
        se1_0.service_name,
        se1_0.service_type 
    from
        service_entity se1_0
2025-11-18T13:05:28.461+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763456728461 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0;
2025-11-18T13:05:28.464+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763456728464 | took 0ms | commit | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.466+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763456728466 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
select b1_0.brand_id,b1_0.brand_name from brand b1_0
select b1_0.brand_id,b1_0.brand_name from brand b1_0;
2025-11-18T13:05:28.466+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763456728466 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
select c1_0.id,c1_0.city from city c1_0
select c1_0.id,c1_0.city from city c1_0;
2025-11-18T13:05:28.475+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763456728475 | took 2ms | commit | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.479+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763456728479 | took 0ms | commit | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:05:28.506+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-10] org.hibernate.SQL                        : 
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)         AVG(re.stars) OVER (PARTITION 
    BY
        b.branch_id) AS avgStars     
    FROM
        branch b     
    LEFT JOIN
        branch_brand_service bbs 
            ON bbs.branch_id = b.branch_id     
    LEFT JOIN
        service_entity s 
            ON s.service_id = bbs.service_id     
    LEFT JOIN
        rate_experience re 
            ON re.branch_brand_serviceid = bbs.id     
    WHERE
        b.status = 'approved' 
        OR b.status = 'APPROVED'     
    ORDER BY
        b.branch_id 
2025-11-18T13:05:28.517+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763456728517 | took 9ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id

    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id
;
2025-11-18T13:05:32.412+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        cbm1_0.id,
        cbm1_0.brand_id,
        cbm1_0.model_name 
    from
        car_brand_model cbm1_0 
    left join
        brand b1_0 
            on b1_0.brand_id=cbm1_0.brand_id 
    where
        b1_0.brand_id=? 
    order by
        cbm1_0.model_name
2025-11-18T13:05:32.415+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-8] org.hibernate.orm.jdbc.bind              : binding parameter (1:BIGINT) <- [1]
2025-11-18T13:05:32.421+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763456732421 | took 5ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
select cbm1_0.id,cbm1_0.brand_id,cbm1_0.model_name from car_brand_model cbm1_0 left join brand b1_0 on b1_0.brand_id=cbm1_0.brand_id where b1_0.brand_id=? order by cbm1_0.model_name
select cbm1_0.id,cbm1_0.brand_id,cbm1_0.model_name from car_brand_model cbm1_0 left join brand b1_0 on b1_0.brand_id=cbm1_0.brand_id where b1_0.brand_id=1 order by cbm1_0.model_name;
2025-11-18T13:05:32.423+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        b1_0.brand_id,
        b1_0.brand_name 
    from
        brand b1_0 
    where
        b1_0.brand_id=?
2025-11-18T13:05:32.424+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-8] org.hibernate.orm.jdbc.bind              : binding parameter (1:BIGINT) <- [1]
2025-11-18T13:05:32.425+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763456732425 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
select b1_0.brand_id,b1_0.brand_name from brand b1_0 where b1_0.brand_id=?
select b1_0.brand_id,b1_0.brand_name from brand b1_0 where b1_0.brand_id=1;
2025-11-18T13:12:21.224+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)         AVG(re.stars) OVER (PARTITION 
    BY
        b.branch_id) AS avgStars     
    FROM
        branch b     
    LEFT JOIN
        branch_brand_service bbs 
            ON bbs.branch_id = b.branch_id     
    LEFT JOIN
        service_entity s 
            ON s.service_id = bbs.service_id     
    LEFT JOIN
        rate_experience re 
            ON re.branch_brand_serviceid = bbs.id     
    WHERE
        b.status = 'approved' 
        OR b.status = 'APPROVED'     
    ORDER BY
        b.branch_id 
2025-11-18T13:12:21.243+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-9] p6spy                                    : #1763457141243 | took 4ms | statement | connection 653| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id

    SELECT
        b.branch_id        AS branchId,
        b.branch_name      AS branchName,
        b.logo_img         AS logoImg,
        b.branch_cover_img AS branchCoverImg,
        s.service_name     AS serviceName,
        -- NEW: average stars per branch (nullable if no ratings)
        AVG(re.stars) OVER (PARTITION BY b.branch_id) AS avgStars
    FROM branch b
    LEFT JOIN branch_brand_service bbs ON bbs.branch_id = b.branch_id
    LEFT JOIN service_entity s ON s.service_id = bbs.service_id
    LEFT JOIN rate_experience re ON re.branch_brand_serviceid = bbs.id
    WHERE b.status = 'approved' OR b.status = 'APPROVED'
    ORDER BY b.branch_id
;
2025-11-18T13:12:21.259+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    select
        se1_0.service_id,
        se1_0.service_name,
        se1_0.service_type 
    from
        service_entity se1_0
2025-11-18T13:12:21.259+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.city 
    from
        city c1_0
2025-11-18T13:12:21.259+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        b1_0.brand_id,
        b1_0.brand_name 
    from
        brand b1_0
2025-11-18T13:12:21.262+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763457141262 | took 1ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
select c1_0.id,c1_0.city from city c1_0
select c1_0.id,c1_0.city from city c1_0;
2025-11-18T13:12:21.262+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763457141262 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0
select se1_0.service_id,se1_0.service_name,se1_0.service_type from service_entity se1_0;
2025-11-18T13:12:21.267+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-1] p6spy                                    : #1763457141267 | took 0ms | commit | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:12:21.267+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-5] p6spy                                    : #1763457141267 | took 0ms | commit | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:12:21.267+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457141267 | took 6ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
select b1_0.brand_id,b1_0.brand_name from brand b1_0
select b1_0.brand_id,b1_0.brand_name from brand b1_0;
2025-11-18T13:12:21.271+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457141271 | took 0ms | commit | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb

;
2025-11-18T13:12:24.024+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        cbm1_0.id,
        cbm1_0.brand_id,
        cbm1_0.model_name 
    from
        car_brand_model cbm1_0 
    left join
        brand b1_0 
            on b1_0.brand_id=cbm1_0.brand_id 
    where
        b1_0.brand_id=? 
    order by
        cbm1_0.model_name
2025-11-18T13:12:24.026+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-6] org.hibernate.orm.jdbc.bind              : binding parameter (1:BIGINT) <- [1]
2025-11-18T13:12:24.036+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457144036 | took 9ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
select cbm1_0.id,cbm1_0.brand_id,cbm1_0.model_name from car_brand_model cbm1_0 left join brand b1_0 on b1_0.brand_id=cbm1_0.brand_id where b1_0.brand_id=? order by cbm1_0.model_name
select cbm1_0.id,cbm1_0.brand_id,cbm1_0.model_name from car_brand_model cbm1_0 left join brand b1_0 on b1_0.brand_id=cbm1_0.brand_id where b1_0.brand_id=1 order by cbm1_0.model_name;
2025-11-18T13:12:24.038+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        b1_0.brand_id,
        b1_0.brand_name 
    from
        brand b1_0 
    where
        b1_0.brand_id=?
2025-11-18T13:12:24.041+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-6] org.hibernate.orm.jdbc.bind              : binding parameter (1:BIGINT) <- [1]
2025-11-18T13:12:24.042+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457144042 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
select b1_0.brand_id,b1_0.brand_name from brand b1_0 where b1_0.brand_id=?
select b1_0.brand_id,b1_0.brand_name from brand b1_0 where b1_0.brand_id=1;
2025-11-18T13:12:41.147+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    SELECT
        DISTINCT b.* 
    FROM
        branch b 
    JOIN
        branch_brand_service bbs 
            ON b.branch_id = bbs.branch_id 
    JOIN
        service_entity se        
            ON se.service_id = bbs.service_id 
    JOIN
        brand br                 
            ON br.brand_id = bbs.brand_id 
    LEFT JOIN
        car_brand_model cbm 
            ON cbm.brand_id = br.brand_id 
    WHERE
        (
            ?   IS NULL 
            OR lower(br.brand_name)    = lower(?)
        )   
        AND (
            ?   IS NULL 
            OR lower(cbm.model_name)   = lower(?)
        )   
        AND (
            ? IS NULL 
            OR lower(se.service_name)  = lower(?)
        )   
        AND b.status = 'approved' 
2025-11-18T13:12:41.148+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (1:VARCHAR) <- [1]
2025-11-18T13:12:41.148+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (2:VARCHAR) <- [1]
2025-11-18T13:12:41.149+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (3:VARCHAR) <- [7]
2025-11-18T13:12:41.149+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (4:VARCHAR) <- [7]
2025-11-18T13:12:41.149+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (5:VARCHAR) <- [1]
2025-11-18T13:12:41.149+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter (6:VARCHAR) <- [1]
2025-11-18T13:12:41.160+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457161160 | took 9ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE (?   IS NULL OR lower(br.brand_name)    = lower(?))
  AND (?   IS NULL OR lower(cbm.model_name)   = lower(?))
  AND (? IS NULL OR lower(se.service_name)  = lower(?))
  AND b.status = 'approved'

SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE ('1'   IS NULL OR lower(br.brand_name)    = lower('1'))
  AND ('7'   IS NULL OR lower(cbm.model_name)   = lower('7'))
  AND ('1' IS NULL OR lower(se.service_name)  = lower('1'))
  AND b.status = 'approved'
;
2025-11-18T13:12:46.791+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    SELECT
        DISTINCT b.* 
    FROM
        branch b 
    JOIN
        branch_brand_service bbs 
            ON b.branch_id = bbs.branch_id 
    JOIN
        service_entity se        
            ON se.service_id = bbs.service_id 
    JOIN
        brand br                 
            ON br.brand_id = bbs.brand_id 
    LEFT JOIN
        car_brand_model cbm 
            ON cbm.brand_id = br.brand_id 
    WHERE
        (
            ?   IS NULL 
            OR lower(br.brand_name)    = lower(?)
        )   
        AND (
            ?   IS NULL 
            OR lower(cbm.model_name)   = lower(?)
        )   
        AND (
            ? IS NULL 
            OR lower(se.service_name)  = lower(?)
        )   
        AND b.status = 'approved' 
2025-11-18T13:12:46.792+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (1:VARCHAR) <- [1]
2025-11-18T13:12:46.792+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (2:VARCHAR) <- [1]
2025-11-18T13:12:46.792+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (3:VARCHAR) <- [7]
2025-11-18T13:12:46.792+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (4:VARCHAR) <- [7]
2025-11-18T13:12:46.793+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (5:VARCHAR) <- [1]
2025-11-18T13:12:46.793+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (6:VARCHAR) <- [1]
2025-11-18T13:12:46.801+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-9] p6spy                                    : #1763457166801 | took 7ms | statement | connection 653| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE (?   IS NULL OR lower(br.brand_name)    = lower(?))
  AND (?   IS NULL OR lower(cbm.model_name)   = lower(?))
  AND (? IS NULL OR lower(se.service_name)  = lower(?))
  AND b.status = 'approved'

SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE ('1'   IS NULL OR lower(br.brand_name)    = lower('1'))
  AND ('7'   IS NULL OR lower(cbm.model_name)   = lower('7'))
  AND ('1' IS NULL OR lower(se.service_name)  = lower('1'))
  AND b.status = 'approved'
;
2025-11-18T13:13:28.243+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208243 | took 2ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:13:28.253+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208253 | took 8ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'SUNDAY'
    LIMIT 1
;
2025-11-18T13:13:28.256+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208256 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:13:28.257+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208257 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:13:28.258+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208258 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:13:28.267+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208267 | took 7ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.268+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208268 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.269+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208269 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.270+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208270 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.272+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208272 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.275+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208275 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.276+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208276 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.278+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208278 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.279+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208279 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.281+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208281 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.282+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208282 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.284+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208284 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.286+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208286 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.287+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208287 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.288+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208288 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.290+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208290 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.292+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208292 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.295+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208295 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.298+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208298 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.301+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208301 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:13:28.304+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208304 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'SUNDAY'
    LIMIT 1
;
2025-11-18T13:13:28.306+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208306 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:13:28.307+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208307 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:13:28.307+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208307 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:13:28.309+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208309 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.310+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208310 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.312+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208312 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.312+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208312 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.315+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208315 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.316+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208316 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.317+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208317 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.318+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208318 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.320+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208320 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.321+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208321 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.322+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208322 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.322+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208322 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.323+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208323 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-02'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:13:28.324+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-2] p6spy                                    : #1763457208324 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:14:28.702+04:00 DEBUG 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    SELECT
        DISTINCT b.* 
    FROM
        branch b 
    JOIN
        branch_brand_service bbs 
            ON b.branch_id = bbs.branch_id 
    JOIN
        service_entity se        
            ON se.service_id = bbs.service_id 
    JOIN
        brand br                 
            ON br.brand_id = bbs.brand_id 
    LEFT JOIN
        car_brand_model cbm 
            ON cbm.brand_id = br.brand_id 
    WHERE
        (
            ?   IS NULL 
            OR lower(br.brand_name)    = lower(?)
        )   
        AND (
            ?   IS NULL 
            OR lower(cbm.model_name)   = lower(?)
        )   
        AND (
            ? IS NULL 
            OR lower(se.service_name)  = lower(?)
        )   
        AND b.status = 'approved' 
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (1:VARCHAR) <- [1]
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (2:VARCHAR) <- [1]
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (3:VARCHAR) <- [1]
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (4:VARCHAR) <- [1]
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (5:VARCHAR) <- [1]
2025-11-18T13:14:28.705+04:00 TRACE 23528 --- [carservices] [http-nio-8081-exec-9] org.hibernate.orm.jdbc.bind              : binding parameter (6:VARCHAR) <- [1]
2025-11-18T13:14:28.710+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-9] p6spy                                    : #1763457268710 | took 4ms | statement | connection 653| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE (?   IS NULL OR lower(br.brand_name)    = lower(?))
  AND (?   IS NULL OR lower(cbm.model_name)   = lower(?))
  AND (? IS NULL OR lower(se.service_name)  = lower(?))
  AND b.status = 'approved'

SELECT DISTINCT b.*
FROM branch b
JOIN branch_brand_service bbs ON b.branch_id = bbs.branch_id
JOIN service_entity se        ON se.service_id = bbs.service_id
JOIN brand br                 ON br.brand_id = bbs.brand_id
LEFT JOIN car_brand_model cbm ON cbm.brand_id = br.brand_id
WHERE ('1'   IS NULL OR lower(br.brand_name)    = lower('1'))
  AND ('1'   IS NULL OR lower(cbm.model_name)   = lower('1'))
  AND ('1' IS NULL OR lower(se.service_name)  = lower('1'))
  AND b.status = 'approved'
;
2025-11-18T13:16:09.283+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369283 | took 14ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:16:09.289+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369289 | took 4ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:16:09.292+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369292 | took 1ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:16:09.293+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369293 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:16:09.295+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369295 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:16:09.301+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369301 | took 5ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.302+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369302 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.303+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369303 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.303+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369303 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.305+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369305 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.307+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369307 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.309+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369309 | took 1ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.310+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369310 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.311+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369311 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.312+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369312 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.313+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369313 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.313+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369313 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.314+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369314 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.314+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369314 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.315+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369315 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.316+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369316 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.316+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369316 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.318+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369318 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.318+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369318 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.321+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369321 | took 2ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:16:09.322+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369322 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:16:09.323+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369323 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:16:09.324+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369324 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:16:09.325+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369325 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:16:09.326+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369326 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.327+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369327 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.327+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369327 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.328+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369328 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.328+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369328 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.328+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369328 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.329+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369329 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.329+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369329 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.330+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369330 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.330+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369330 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.331+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369331 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.331+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369331 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.333+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369333 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:16:09.333+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-8] p6spy                                    : #1763457369333 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:17:35.331+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455331 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:17:35.332+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455332 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:17:35.333+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455333 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:17:35.335+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455335 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:17:35.335+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455335 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:17:35.336+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455336 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.338+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455338 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.338+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455338 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.339+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455339 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.339+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455339 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.341+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455341 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.342+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455342 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.343+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455343 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.343+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455343 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.344+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455344 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.345+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455345 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.345+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455345 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.346+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455346 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.346+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455346 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.347+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455347 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.348+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455348 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.349+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455349 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.349+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455349 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.350+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455350 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.350+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455350 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:17:35.351+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455351 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:17:35.351+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455351 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:17:35.352+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455352 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:17:35.352+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455352 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:17:35.353+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455353 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.354+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455354 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.354+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455354 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.354+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455354 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.355+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455355 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.355+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455355 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.357+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455357 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.358+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455358 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.358+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455358 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.359+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455359 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.360+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455360 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.361+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455361 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.361+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455361 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:17:35.362+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457455362 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:18:18.361+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498361 | took 1ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:18:18.363+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498363 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:18.365+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498365 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:18.366+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498366 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:18.367+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498367 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:18.368+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498368 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.370+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498370 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.371+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498371 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.372+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498372 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.373+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498373 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.373+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498373 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.375+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498375 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.375+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498375 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.375+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498375 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.376+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498376 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.376+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498376 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.377+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498377 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.377+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498377 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.379+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498379 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.379+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498379 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.380+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498380 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.380+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498380 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.381+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498381 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.382+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498382 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.383+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498383 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:18:18.386+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498386 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:18.387+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498387 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:18.388+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498388 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:18.389+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498389 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:18.390+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498390 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.391+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498391 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.392+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498392 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.393+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498393 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.394+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498394 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.395+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498395 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.395+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498395 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.396+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498396 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.396+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498396 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.397+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498397 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.398+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498398 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.399+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498399 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.399+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498399 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:18.400+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-6] p6spy                                    : #1763457498400 | took 0ms | statement | connection 651| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:18:22.243+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502243 | took 19ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:18:22.249+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502249 | took 5ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:22.250+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502250 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:22.251+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502251 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:22.256+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502256 | took 3ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:22.263+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502263 | took 6ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.265+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502265 | took 1ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.266+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502266 | took 1ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.268+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502268 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.270+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502270 | took 1ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.271+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502271 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.272+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502272 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.273+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502273 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.274+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502274 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.275+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502275 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.276+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502276 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.277+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502277 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.278+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502278 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.279+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502279 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.279+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502279 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.281+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502281 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.283+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502283 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.285+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502284 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.285+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502285 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.288+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502288 | took 2ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:18:22.289+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502289 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:22.291+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502291 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:22.291+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502291 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:22.292+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502292 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:22.293+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502293 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.294+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502294 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.294+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502294 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.295+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502295 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.296+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502296 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.297+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502297 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.297+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502297 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.298+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502298 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.300+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502300 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.300+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502300 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.302+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502302 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.302+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502302 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.302+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502302 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:22.305+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-3] p6spy                                    : #1763457502305 | took 0ms | statement | connection 652| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:18:33.268+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513268 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:18:33.270+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513270 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:33.272+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513272 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:33.273+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513273 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:33.274+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513274 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:33.275+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513275 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.275+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513275 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.276+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513276 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.277+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513277 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.279+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513279 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.279+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513279 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.280+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513280 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.281+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513281 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.282+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513282 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.283+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513283 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.284+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513284 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.285+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513285 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.286+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513286 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.290+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513290 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.294+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513294 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.295+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513295 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.295+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513295 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.296+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513296 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.296+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513296 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.298+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513298 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:18:33.299+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513299 | took 1ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:18:33.301+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513301 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:33.302+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513302 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:18:33.303+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513303 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:18:33.304+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513304 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.306+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513306 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.307+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513307 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.309+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513309 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.309+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513309 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.311+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513310 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.311+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513311 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.312+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513312 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.313+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513313 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.314+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513314 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.314+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513314 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.314+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513314 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.315+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513315 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:18:33.316+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-10] p6spy                                    : #1763457513316 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:20:18.191+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618191 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:20:18.193+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618193 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:20:18.194+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618194 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:20:18.196+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618196 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:20:18.196+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618196 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:20:18.197+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618197 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.198+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618198 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.199+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618199 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.200+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618200 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.200+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618200 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.201+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618201 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.202+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618202 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.218+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618218 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.219+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618219 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.221+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618221 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.222+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618222 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.222+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618222 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.223+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618223 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.224+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618224 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.226+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618226 | took 2ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.227+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618227 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.228+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618228 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.228+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618228 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.229+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618229 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.229+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618229 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:20:18.230+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618230 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:20:18.231+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618231 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:20:18.231+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618231 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:20:18.232+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618232 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:20:18.232+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618232 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.232+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618232 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.233+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618233 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.233+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618233 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.234+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618234 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.235+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618235 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.235+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618235 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.236+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618236 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.236+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618236 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.237+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618237 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.238+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618238 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.238+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618238 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.238+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618238 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:20:18.240+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-7] p6spy                                    : #1763457618240 | took 0ms | statement | connection 650| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:32:05.773+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325773 | took 11ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE ?
      AND s.brand_id = ?
      AND s.service_id = ?

    SELECT b.branch_id, b.branch_name, b.city, b.logo_img, b.latitude, b.longitude
    FROM branch b
    JOIN branch_brand_service s ON s.branch_id = b.branch_id
    WHERE b.city ILIKE 'Dubai'
      AND s.brand_id = 1
      AND s.service_id = 1
;
2025-11-18T13:32:05.782+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325782 | took 4ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 1
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:32:05.784+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325784 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:32:05.785+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325785 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 1
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:32:05.789+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325789 | took 3ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:32:05.807+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325807 | took 8ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.810+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325810 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.812+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325812 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.813+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325813 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.815+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325815 | took 1ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.817+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325817 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.819+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325819 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.820+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325820 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.821+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325821 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.822+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325822 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.822+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325822 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.823+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325823 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.824+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325824 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.827+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325827 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.829+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325829 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.829+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325829 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T16:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.829+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325829 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.831+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325831 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T17:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.832+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325832 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 1
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T18:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.834+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325834 | took 1ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 1
;
2025-11-18T13:32:05.835+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325835 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = ?
      AND UPPER(working_day) = ?
    LIMIT 1

    SELECT status,
           "from" AS from_time,
           "to"   AS to_time
    FROM work_days
    WHERE branch_id = 2
      AND UPPER(working_day) = 'TUESDAY'
    LIMIT 1
;
2025-11-18T13:32:05.837+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325837 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(qty), 0) AS total_qty
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:32:05.837+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325837 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = ?
 AND brand_id = 1 AND service_id = 1
    SELECT COALESCE(SUM(experts), 0) AS total_experts
    FROM branch_brand_service
    WHERE branch_id = 2
 AND brand_id = 1 AND service_id = 1;
2025-11-18T13:32:05.837+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325837 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
SELECT UPPER(service_type) FROM service_entity WHERE service_id = ?
SELECT UPPER(service_type) FROM service_entity WHERE service_id = 1;
2025-11-18T13:32:05.838+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325837 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.838+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325838 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T09:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.838+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325838 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.840+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325840 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T10:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.843+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325843 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.845+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325845 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T11:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.845+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325845 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.846+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325846 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T12:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.846+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325846 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.847+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325847 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T13:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.847+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325847 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.847+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325847 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T14:30:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.848+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325848 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = ?
      AND r.reservation_date = ?
      AND r.reservation_time = ?
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1
    SELECT
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) = 'BOX'
                          THEN 1 ELSE 0 END), 0) AS box_reserved,
        COALESCE(SUM(CASE WHEN UPPER(se.service_type) <> 'BOX'
                          THEN 1 ELSE 0 END), 0) AS non_box_reserved
    FROM reservation_service_request r
    JOIN service_entity se ON r.service_id = se.service_id
    WHERE r.branch_id = 2
      AND r.reservation_date = '2025-11-18'
      AND r.reservation_time = '1970-01-01T15:00:00.000+0400'
     /* AND (r.reservation_status IS NULL OR LOWER(r.reservation_status) <> 'canceled') */
 AND r.brand_id = 1;
2025-11-18T13:32:05.848+04:00  INFO 23528 --- [carservices] [http-nio-8081-exec-4] p6spy                                    : #1763458325848 | took 0ms | statement | connection 660| url jdbc:p6spy:postgresql://localhost:5433/testdb
    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = ?

    SELECT r.stars
    FROM rate_experience r
    JOIN branch_brand_service bbs ON bbs.id = r.branch_brand_serviceid
    WHERE bbs.branch_id = 2
;
2025-11-18T13:38:20.984+04:00  INFO 23528 --- [carservices] [File Watcher] rtingClassPathChangeChangedEventListener : Restarting due to 401 class path changes (0 additions, 401 deletions, 0 modifications)
2025-11-18T13:38:21.123+04:00  INFO 23528 --- [carservices] [Thread-159] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-11-18T13:38:21.391+04:00  INFO 23528 --- [carservices] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-11-18T13:38:21.584+04:00  INFO 23528 --- [carservices] [Thread-159] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-18T13:38:21.623+04:00  INFO 23528 --- [carservices] [Thread-159] com.zaxxer.hikari.HikariDataSource       : HikariPool-41 - Shutdown initiated...
2025-11-18T13:38:21.709+04:00  INFO 23528 --- [carservices] [Thread-159] com.zaxxer.hikari.HikariDataSource       : HikariPool-41 - Shutdown completed.
2025-11-18T13:38:29.637+04:00  INFO 23528 --- [carservices] [restartedMain] c.c.carservices.CarservicesApplication   : Starting CarservicesApplication using Java 21.0.7 with PID 23528 (C:\Grand BackUp\Sheikh-2\Private\Sheikhkashifiqbal\temp\Spare Parts Project\SpringBoot\car-dev-1\carservices\target\classes started by lenovo in C:\Grand BackUp\Sheikh-2\Private\Sheikhkashifiqbal\temp\Spare Parts Project\SpringBoot\car-dev-1\carservices)
2025-11-18T13:38:29.637+04:00  INFO 23528 --- [carservices] [restartedMain] c.c.carservices.CarservicesApplication   : No active profile set, falling back to 1 default profile: "default"
2025-11-18T13:38:30.843+04:00  INFO 23528 --- [carservices] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-18T13:38:31.245+04:00  INFO 23528 --- [carservices] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 399 ms. Found 36 JPA repository interfaces.
2025-11-18T13:38:31.575+04:00  INFO 23528 --- [carservices] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-11-18T13:38:31.576+04:00  INFO 23528 --- [carservices] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-18T13:38:31.576+04:00  INFO 23528 --- [carservices] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-11-18T13:38:31.621+04:00  INFO 23528 --- [carservices] [restartedMain] o.a.c.c.C.[Tomcat-8].[localhost].[/]     : Initializing Spring embedded WebApplicationContext
2025-11-18T13:38:31.622+04:00  INFO 23528 --- [carservices] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1980 ms
2025-11-18T13:38:31.838+04:00  INFO 23528 --- [carservices] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-18T13:38:31.851+04:00  INFO 23528 --- [carservices] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-11-18T13:38:31.894+04:00  INFO 23528 --- [carservices] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-18T13:38:31.896+04:00  INFO 23528 --- [carservices] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-42 - Starting...
2025-11-18T13:38:31.992+04:00  INFO 23528 --- [carservices] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-42 - Added connection com.p6spy.engine.wrapper.ConnectionWrapper@2cdece86
2025-11-18T13:38:31.993+04:00  INFO 23528 --- [carservices] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-42 - Start completed.
2025-11-18T13:38:32.029+04:00  WARN 23528 --- [carservices] [restartedMain] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-18T13:38:32.034+04:00  INFO 23528 --- [carservices] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-42)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-18T13:38:32.881+04:00  INFO 23528 --- [carservices] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-18T13:38:32.913+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458712913 | took 29ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from information_schema.sequences
select * from information_schema.sequences;
2025-11-18T13:38:32.982+04:00  INFO 23528 --- [carservices] [restartedMain] t.s.e.i.AbstractInformationExtractorImpl : HHH000475: Cannot locate column information using identifier [lower((manager_email)::text)]; ignoring index [ux_company_manager_email]
2025-11-18T13:38:32.984+04:00 DEBUG 23528 --- [carservices] [restartedMain] org.hibernate.SQL                        : 
    alter table if exists company 
       drop constraint if exists ux_company_company_name_ci
2025-11-18T13:38:32.993+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458712993 | took 8ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb

    alter table if exists company 
       drop constraint if exists ux_company_company_name_ci

    alter table if exists company 
       drop constraint if exists ux_company_company_name_ci;
2025-11-18T13:38:32.994+04:00  WARN 23528 --- [carservices] [restartedMain] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Warning Code: 0, SQLState: 00000
2025-11-18T13:38:32.994+04:00  WARN 23528 --- [carservices] [restartedMain] o.h.engine.jdbc.spi.SqlExceptionHelper   : constraint "ux_company_company_name_ci" of relation "company" does not exist, skipping
2025-11-18T13:38:32.994+04:00 DEBUG 23528 --- [carservices] [restartedMain] org.hibernate.SQL                        : 
    alter table if exists company 
       add constraint ux_company_company_name_ci unique (company_name)
2025-11-18T13:38:33.024+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713024 | took 29ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb

    alter table if exists company 
       add constraint ux_company_company_name_ci unique (company_name)

    alter table if exists company 
       add constraint ux_company_company_name_ci unique (company_name);
2025-11-18T13:38:33.024+04:00 DEBUG 23528 --- [carservices] [restartedMain] org.hibernate.SQL                        : 
    alter table if exists company 
       drop constraint if exists ux_company_brand_name_ci
2025-11-18T13:38:33.025+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713025 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb

    alter table if exists company 
       drop constraint if exists ux_company_brand_name_ci

    alter table if exists company 
       drop constraint if exists ux_company_brand_name_ci;
2025-11-18T13:38:33.026+04:00  WARN 23528 --- [carservices] [restartedMain] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Warning Code: 0, SQLState: 00000
2025-11-18T13:38:33.026+04:00  WARN 23528 --- [carservices] [restartedMain] o.h.engine.jdbc.spi.SqlExceptionHelper   : constraint "ux_company_brand_name_ci" of relation "company" does not exist, skipping
2025-11-18T13:38:33.026+04:00 DEBUG 23528 --- [carservices] [restartedMain] org.hibernate.SQL                        : 
    alter table if exists company 
       add constraint ux_company_brand_name_ci unique (brand_name)
2025-11-18T13:38:33.029+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713029 | took 2ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb

    alter table if exists company 
       add constraint ux_company_brand_name_ci unique (brand_name)

    alter table if exists company 
       add constraint ux_company_brand_name_ci unique (brand_name);
2025-11-18T13:38:33.200+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713200 | took 3ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."company" where 1=0
select * from "public"."company" where 1=0;
2025-11-18T13:38:33.331+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713331 | took 3ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."branch" where 1=0
select * from "public"."branch" where 1=0;
2025-11-18T13:38:33.341+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713341 | took 2ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."brand" where 1=0
select * from "public"."brand" where 1=0;
2025-11-18T13:38:33.349+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713349 | took 2ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."service_entity" where 1=0
select * from "public"."service_entity" where 1=0;
2025-11-18T13:38:33.469+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713469 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."branch" where 1=0
select * from "public"."branch" where 1=0;
2025-11-18T13:38:33.472+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713472 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."brand" where 1=0
select * from "public"."brand" where 1=0;
2025-11-18T13:38:33.478+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713477 | took 2ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."spare_parts" where 1=0
select * from "public"."spare_parts" where 1=0;
2025-11-18T13:38:33.629+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713629 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."brand" where 1=0
select * from "public"."brand" where 1=0;
2025-11-18T13:38:33.762+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713762 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."brand" where 1=0
select * from "public"."brand" where 1=0;
2025-11-18T13:38:33.769+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713769 | took 4ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."user_registration" where 1=0
select * from "public"."user_registration" where 1=0;
2025-11-18T13:38:33.948+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458713948 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."spare_parts" where 1=0
select * from "public"."spare_parts" where 1=0;
2025-11-18T13:38:34.091+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458714091 | took 3ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."problem" where 1=0
select * from "public"."problem" where 1=0;
2025-11-18T13:38:34.226+04:00  INFO 23528 --- [carservices] [restartedMain] p6spy                                    : #1763458714226 | took 0ms | statement | connection 670| url jdbc:p6spy:postgresql://localhost:5433/testdb
select * from "public"."branch" where 1=0
select * from "public"."branch" where 1=0;
2025-11-18T13:38:34.227+04:00  INFO 23528 --- [carservices] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-18T13:38:35.928+04:00  WARN 23528 --- [carservices] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-18T13:38:36.340+04:00  INFO 23528 --- [carservices] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2025-11-18T13:38:36.370+04:00  INFO 23528 --- [carservices] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-11-18T13:38:36.376+04:00  INFO 23528 --- [carservices] [restartedMain] c.c.carservices.CarservicesApplication   : Started CarservicesApplication in 6.867 seconds (process running for 96725.582)
2025-11-18T13:38:36.379+04:00  INFO 23528 --- [carservices] [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2025-11-18T13:40:48.321+04:00  INFO 23528 --- [carservices] [File Watcher] rtingClassPathChangeChangedEventListener : Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-11-18T13:40:48.323+04:00  INFO 23528 --- [carservices] [Thread-172] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-11-18T13:40:48.333+04:00  INFO 23528 --- [carservices] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-11-18T13:40:48.345+04:00  INFO 23528 --- [carservices] [Thread-172] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-18T13:40:48.347+04:00  INFO 23528 --- [carservices] [Thread-172] com.zaxxer.hikari.HikariDataSource       : HikariPool-42 - Shutdown initiated...
2025-11-18T13:40:48.351+04:00  INFO 23528 --- [carservices] [Thread-172] com.zaxxer.hikari.HikariDataSource       : HikariPool-42 - Shutdown completed.
2025-11-18T13:40:48.482+04:00  INFO 23528 --- [carservices] [restartedMain] c.c.carservices.CarservicesApplication   : Starting CarservicesApplication using Java 21.0.7 with PID 23528 (C:\Grand BackUp\Sheikh-2\Private\Sheikhkashifiqbal\temp\Spare Parts Project\SpringBoot\car-dev-1\carservices\target\classes started by lenovo in C:\Grand BackUp\Sheikh-2\Private\Sheikhkashifiqbal\temp\Spare Parts Project\SpringBoot\car-dev-1\carservices)
2025-11-18T13:40:48.483+04:00  INFO 23528 --- [carservices] [restartedMain] c.c.carservices.CarservicesApplication   : No active profile set, falling back to 1 default profile: "default"
